!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):t.Onboard=e(t.d3)}(this,function(t){"use strict";function e(t){var e=void 0===t?"undefined":d(t);return null!=t&&("object"==e||"function"==e)}function n(t){var e=z.call(t,A),n=t[A];try{t[A]=void 0;var i=!0}catch(t){}var r=C.call(t);return i&&(e?t[A]=n:delete t[A]),r}function i(t){return M.call(t)}function r(t){return null==t?void 0===t?P:N:R&&R in Object(t)?n(t):i(t)}function o(t){return null!=t&&"object"==(void 0===t?"undefined":d(t))}function s(t){return"symbol"==(void 0===t?"undefined":d(t))||o(t)&&r(t)==T}function a(t){if("number"==typeof t)return t;if(s(t))return W;if(e(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=e(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(D,"");var i=Z.test(t);return i||L.test(t)?O(t.slice(2),i?2:8):j.test(t)?W:+t}function l(t,n,i){function r(e){var n=c,i=w;return c=w=void 0,y=e,g=t.apply(i,n)}function o(t){return y=t,b=setTimeout(h,n),m?r(t):g}function s(t){var e=t-v,i=t-y,r=n-e;return x?Y(r,f-i):r}function l(t){var e=t-v,i=t-y;return void 0===v||e>=n||e<0||x&&i>=f}function h(){var t=S();if(l(t))return d(t);b=setTimeout(h,s(t))}function d(t){return b=void 0,k&&c?r(t):(c=w=void 0,g)}function u(){void 0!==b&&clearTimeout(b),y=0,c=v=w=b=void 0}function _(){return void 0===b?g:d(S())}function p(){var t=S(),e=l(t);if(c=arguments,w=this,v=t,e){if(void 0===b)return o(v);if(x)return b=setTimeout(h,n),r(v)}return void 0===b&&(b=setTimeout(h,n)),g}var c,w,f,g,b,v,y=0,m=!1,x=!1,k=!0;if("function"!=typeof t)throw new TypeError(G);return n=a(n)||0,e(i)&&(m=!!i.leading,x="maxWait"in i,f=x?H(a(i.maxWait)||0,n):f,k="trailing"in i?!!i.trailing:k),p.cancel=u,p.flush=_,p}function h(t,e){return void 0===t?e:t}var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},_=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),p=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];u(this,t),this._handlers=e.reduce(function(t,e){return t[e]=[],t},{})}return _(t,[{key:"on",value:function(t,e){var n=this;if(!(t in this._handlers))throw"No such event: "+t;return this._handlers[t].push(e),{destroy:function(){n.off(t,e)}}}},{key:"off",value:function(t,e){if(!(t in this._handlers))throw"No such event: "+t;if(e){var n=this._handlers[t],i=n.indexOf(e);-1!=i&&n.splice(i,1)}else this._handlers[t]=[];return this}},{key:"fire",value:function(t){if(!(t in this._handlers))throw"No such event: "+t;for(var e=this._handlers[t],n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];for(var o=0;o<e.length;o++)e[o].apply(this,i);return this}},{key:"destroy",value:function(){return this._handlers=null,this}}]),t}(),c="#343A3D",w=.5,f=200,g="Next",b="",v=400,y=function(t,e){if("undefined"==typeof document)return e;t=t||"";var n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");return i.type="text/css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t)),n.appendChild(i),e}("._svg_1b1z4_13 {\r\n    position:absolute;\r\n    top:0;\r\n    left:0;\r\n    z-index:10;\r\n}\r\n\r\n._bg_1b1z4_27 {\r\n\r\n}\r\n\r\n._mask_1b1z4_35 {\r\n\r\n}\r\n\r\n._window_1b1z4_43 {\r\n    display: none;\r\n    position:absolute;\r\n    z-index:11;\r\n    left:calc(50% - 200px);\r\n    padding-bottom:90px;\r\n    top:calc(50vh - 200px);\r\n    border-radius: 5px;\r\n    background-color: #ffffff;\r\n    box-shadow: 0 15px 20px 0 rgba(0, 0, 0, .2);\r\n    font-family: Roboto;\r\n    overflow: hidden;\r\n}\r\n\r\n._window-next-btn_1b1z4_71 {\r\n    display: block;\r\n    position: absolute;\r\n    right:30px;\r\n    text-align: left;\r\n    bottom:30px;\r\n    padding:6px 15px 6px 15px;\r\n    text-transform: uppercase;\r\n    cursor: pointer;\r\n    box-sizing: border-box;\r\n    border-radius: 5px;\r\n    font-size: 10px;\r\n    background-color:white;\r\n    font-weight: bold;\r\n    letter-spacing: 1px;\r\n    -webkit-user-select: none;\r\n       -moz-user-select: none;\r\n        -ms-user-select: none;\r\n            user-select: none;\r\n    color:#49ace2;\r\n    border:solid 2px #49ace2    \r\n}\r\n\r\n._window-next-btn_1b1z4_71 span {\r\n    font-weight:bold;\r\n}\r\n\r\n._window-next-btn_1b1z4_71 ._window-btn-icon_1b1z4_117 {\r\n    font-size:19px;\r\n    position:absolute;\r\n    display:none;\r\n    right:15px;\r\n    top:5px;\r\n}\r\n\r\n._window-next-btn-hover_1b1z4_135 {\r\n    color:white;\r\n    background-color:#49ace2;\r\n}\r\n\r\n._window-button-has-next_1b1z4_145 {\r\n    padding: 6px 50px 6px 15px\r\n}\r\n\r\n._window-button-has-next_1b1z4_145 ._window-btn-icon_1b1z4_117 {\r\n    display:block;\r\n}\r\n\r\n._window-prev-btn_1b1z4_161 {\r\n    display: block;\r\n    position: absolute;\r\n    left:30px;\r\n    bottom:30px;\r\n    text-transform: uppercase;\r\n    padding:5px 0px;\r\n    color:#cacaca;\r\n    pointer-events: none;\r\n    cursor: default\r\n}\r\n\r\n._window-prev-btn_1b1z4_161 >._window-btn-icon_1b1z4_117 {\r\n    font-size:19px;\r\n}\r\n\r\n._window-title_1b1z4_193 {\r\n    position:relative;\r\n    margin-top:25px;\r\n    margin-left:30px;\r\n    font-size: 16px;\r\n    font-weight: bold;\r\n}\r\n\r\n._window-body_1b1z4_209 {\r\n    position:relative;\r\n    margin-top:19px;\r\n    margin-left:30px;\r\n    margin-right: 30px;\r\n    font-size: 12px;\r\n    line-height: 1.5;\r\n}\r\n\r\n._window-button-has-prev_1b1z4_227 {\r\n    color:#cacaca;\r\n    pointer-events: all;\r\n    cursor: pointer;\r\n}\r\n\r\n._window-button-has-prev_1b1z4_227:hover {\r\n    color:#49ace2;\r\n}\r\n\r\n._arrow_1b1z4_247 {\r\n    position: absolute;\r\n    z-index:11;\r\n    visibility: hidden;\r\n    width:71px;\r\n    top:0px;\r\n    left:0px;\r\n    height: 63px;\r\n    background-image:url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNzFweCIgaGVpZ2h0PSI2M3B4IiB2aWV3Qm94PSIwIDAgNzEgNjMiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDQzLjIgKDM5MDY5KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5Hcm91cCAyPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+PC9kZWZzPgogICAgPGcgaWQ9IlBhZ2UtMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj4KICAgICAgICA8ZyBpZD0iM18xX0ZJTFRSWSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTc5MC4wMDAwMDAsIC03Ni4wMDAwMDApIiBzdHJva2U9IiNGRkZGRkYiIHN0cm9rZS13aWR0aD0iMyI+CiAgICAgICAgICAgIDxnIGlkPSJJTkZPIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MzEuNTEzNzY1LCA3OC4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSJHcm91cC0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzNTkuNDg2MjM1LCAwLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLjQ4NjIzNTI1LDU5IEM0LjI2OTE5MTY5LDIwLjI5MzE0OCAyNC42Nzk1NDEyLDYuMDEyNzE4NjEgNjAsNi4wMTI3MTg2MSIgaWQ9IlBhdGgtMiIgc3Ryb2tlLWRhc2hhcnJheT0iMSw3Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBvbHlsaW5lIGlkPSJQYXRoLTMiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHBvaW50cz0iNjIgMS40MjEwODU0N2UtMTQgNjguNDg5MTgyNyA1Ljg3MDc3NzgyIDYyLjM0ODc4ODMgMTEuODUyNTczNSI+PC9wb2x5bGluZT4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+');\r\n}\r\n\r\n._arrow-right-top_1b1z4_269 {\r\n    -webkit-transform: rotate(0deg);\r\n            transform: rotate(0deg);\r\n    margin-left: -20px;\r\n    margin-top: -8px;\r\n}\r\n\r\n._arrow-right-bottom_1b1z4_281 {\r\n    -webkit-transform: scaleY(-1);\r\n            transform: scaleY(-1);\r\n    margin-left: -20px;\r\n    margin-top: -8px;\r\n}\r\n\r\n._arrow-left-top_1b1z4_293 {\r\n    -webkit-transform: rotate(-90deg);\r\n            transform: rotate(-90deg);\r\n    margin-left: -8px;\r\n    margin-top: 20px;\r\n}\r\n\r\n._arrow-left-bottom_1b1z4_305 {\r\n    margin-left: -8px;\r\n    margin-top: -20px;\r\n    -webkit-transform: scaleY(-1) rotate(-90deg);\r\n            transform: scaleY(-1) rotate(-90deg);\r\n}\r\n\r\n._window-right-top_1b1z4_317 {\r\n    \r\n}\r\n\r\n._window-close_1b1z4_325 {\r\n    position:absolute;\r\n    right:30px;\r\n    top:25px;\r\n    font-size: 18px;\r\n    width:15px;\r\n    height:15px;\r\n    color:#cacaca;\r\n    cursor: pointer;\r\n}\r\n\r\n._window-close_1b1z4_325:hover {\r\n    color:black;\r\n}\r\n\r\n._window-progress-ct_1b1z4_355 {\r\n    background-color:#49ace2;\r\n    height: 5px;\r\n    left: 0px;\r\n    top: 0px;\r\n    overflow: hidden;\r\n    width:0px;\r\n    position: absolute;\r\n}\r\n\r\n._window-progress-step_1b1z4_375 {\r\n    position: relative;\r\n    height:5px;\r\n    border-right:2px solid white;\r\n    background-color: transparent;\r\n    float:left;\r\n}\r\n",{svg:"_svg_1b1z4_13",bg:"_bg_1b1z4_27","-webkit-mask":"_mask_1b1z4_35",mask:"_mask_1b1z4_35",window:"_window_1b1z4_43","window-next-btn":"_window-next-btn_1b1z4_71","window-btn-icon":"_window-btn-icon_1b1z4_117","window-next-btn-hover":"_window-next-btn-hover_1b1z4_135","window-button-has-next":"_window-button-has-next_1b1z4_145","window-prev-btn":"_window-prev-btn_1b1z4_161","window-title":"_window-title_1b1z4_193","window-body":"_window-body_1b1z4_209","window-button-has-prev":"_window-button-has-prev_1b1z4_227",arrow:"_arrow_1b1z4_247","arrow-right-top":"_arrow-right-top_1b1z4_269","arrow-right-bottom":"_arrow-right-bottom_1b1z4_281","arrow-left-top":"_arrow-left-top_1b1z4_293","arrow-left-bottom":"_arrow-left-bottom_1b1z4_305","window-right-top":"_window-right-top_1b1z4_317","window-close":"_window-close_1b1z4_325","window-progress-ct":"_window-progress-ct_1b1z4_355","window-progress-step":"_window-progress-step_1b1z4_375"}),m="object"==("undefined"==typeof global?"undefined":d(global))&&global&&global.Object===Object&&global,x="object"==("undefined"==typeof self?"undefined":d(self))&&self&&self.Object===Object&&self,k=m||x||Function("return this")(),S=function(){return k.Date.now()},I=k.Symbol,E=Object.prototype,z=E.hasOwnProperty,C=E.toString,A=I?I.toStringTag:void 0,B=Object.prototype,M=B.toString,N="[object Null]",P="[object Undefined]",R=I?I.toStringTag:void 0,T="[object Symbol]",W=NaN,D=/^\s+|\s+$/g,j=/^[-+]0x[0-9a-f]+$/i,Z=/^0b[01]+$/i,L=/^0o[0-7]+$/i,O=parseInt,G="Expected a function",H=Math.max,Y=Math.min,K=function(){function e(t,n){u(this,e),this._options=t,this._containerEl=null,this._svgEl=null,this._stepElements=[],this._rendered=!1,this._model=n,this._onStartBinding=this._model.on("start",this._onStart.bind(this)),this._onStepBinding=this._model.on("step",this._onStep.bind(this)),this._onStopBinding=this._model.on("stop",this._onStop.bind(this))}return _(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"render",value:function(e){return this._containerEl=t.select(e||document.body),this._renderMask(),this._rendered=!0,this}},{key:"_getViewSize",value:function(){return{width:Math.max(document.documentElement.offsetWidth,document.documentElement.clientWidth),height:Math.max(document.documentElement.offsetHeight,document.documentElement.clientHeight)}}},{key:"_renderMask",value:function(){var t=this,e=this._getViewSize();this._svgEl=this._containerEl.append("svg").attr("class",y.svg).attr("width",e.width).attr("height",e.height),this._defsEl=this._svgEl.append("defs"),this._maskEl=this._defsEl.append("mask").attr("class",y.mask).attr("id","onboarding-mask").attr("width","100%").attr("height","100%").attr("x",0).attr("y",0),this._maskBg=this._maskEl.append("rect").attr("class",y.bg).attr("x",0).attr("y",0).attr("width","100%").attr("height","100%").attr("fill","white"),this._bgEl=this._svgEl.append("rect").attr("class",y.bg).attr("width","100%").attr("height","100%").attr("x",0).attr("y",0).attr("mask","url(#onboarding-mask)").attr("fill",this._options.fillColor).attr("fill-opacity",this._options.fillOpacity),this._onWindowResize=l(function(){var e=t._getViewSize();t._svgEl.attr("width",e.width),t._svgEl.attr("height",e.height),t._step&&(t._clearSteps(),t._renderStep(t._step))},200),window.addEventListener("resize",this._onWindowResize)}},{key:"_clearSteps",value:function(){this._stepElements.forEach(function(t){return t.remove()})}},{key:"_renderStep",value:function(e){var n=this;if(e.selector){t.selectAll(e.selector).nodes().forEach(function(t){n._stepElements.push(n._renderStepElement(t,e))})}}},{key:"_renderStepElement",value:function(t,e){var n=e.shape||{type:"rectangle"};return"path"==t.tagName?this._renderPathMask(t,e):"circle"==n.type?this._renderCircleMask(t,e):this._renderRectangleMask(t,e)}},{key:"_getBorderRadius",value:function(t){return parseFloat(window.getComputedStyle(t,null).getPropertyValue("border-top-left-radius"))}},{key:"_getBox",value:function(t){var e=t.getBoundingClientRect();return{top:e.top+ +document.body.scrollTop,left:e.left+ +document.body.scrollLeft,width:e.width,height:e.height}}},{key:"_renderRectangleMask",value:function(t,e){var n=this._getBox(t),i=this._getBorderRadius(t),r=e.shape||{},o=r.offset||[0,0];return e.shape&&e.shape.radius&&(i=e.shape.radius),this._maskEl.append("rect").attr("fill","black").attr("x",n.left+o[0]).attr("y",n.top+o[1]).attr("rx",i).attr("ry",i).attr("width",r.width||n.width).attr("fill-opacity",1).attr("stroke-opacity",1).attr("stroke-width",r.strokeWidth||0).attr("stroke","black").attr("height",r.height||n.height)}},{key:"_renderCircleMask",value:function(t,e){var n=this._getBox(t),i=n.left+n.width/2,r=n.top+n.height/2,o=e.shape||{},s=o.offset||[0,0];return this._maskEl.append("circle").attr("r",e.shape.radius||n.width/2).attr("fill","black").attr("fill-opacity",1).attr("stroke-width",o.strokeWidth||0).attr("stroke-opacity",1).attr("stroke","black").attr("cx",i+s[0]).attr("cy",r+s[1])}},{key:"_renderPathMask",value:function(e,n){for(var i=e.parentElement;i&&"svg"!=i.tagName;)i=i.parentElement;var r=this._getBox(i);return this._maskEl.append("g").attr("transform","translate("+r.left+", "+r.top+")").append("path").attr("fill","black").attr("fill-opacity",1).attr("stroke-width",n.shape?n.shape.strokeWidth||0:0).attr("stroke","black").attr("d",t.select(e).attr("d"))}},{key:"_onStart",value:function(){return this._svgEl.style("display","block"),this}},{key:"_onStep",value:function(t){return this._step=t,this._clearSteps(),this._renderStep(t),this}},{key:"_onStop",value:function(){return this._step=null,this._svgEl.style("display","none"),this}},{key:"destroy",value:function(){return this._rendered&&window.removeEventListener("resize",this._onWindowResize),this._clearSteps(),this._onStartBinding.destroy(),this._onStepBinding.destroy(),this._onStopBinding.destroy(),this}}]),e}(),J=function(){function t(){u(this,t)}return _(t,[{key:"getWindowPosition",value:function(t,e,n){var i=this._getTargetPosition(t,n);return{position:i,left:this._getLeftWindowPosition(i,t,n,e),top:this._getTopWindowPosition(i,t,n,e)}}},{key:"_getLeftWindowPosition",value:function(t,e,n,i){return{"left-top":e.left+e.width/2+n.width,"right-top":e.left-n.width-i.width,"left-bottom":e.left+e.width/2+n.width,"right-bottom":e.left-i.width-n.width}[t]}},{key:"_getTopWindowPosition",value:function(t,e,n,i){return{"left-top":e.top+e.height+n.height,"right-top":e.top+e.height/2+n.height,"left-bottom":e.top-i.height-n.height,"right-bottom":e.top-i.height+n.height}[t]}},{key:"getArrowPosition",value:function(t,e){var n=this._getTargetPosition(t,e);return{position:n,left:this._getLeftArrowPosition(n,t,e),top:this._getTopArrowPosition(n,t,e)}}},{key:"_getLeftArrowPosition",value:function(t,e,n){return{"left-top":e.left+e.width/2,"right-top":e.left-n.width,"left-bottom":e.left+e.width/2,"right-bottom":e.left-n.width}[t]}},{key:"_getTopArrowPosition",value:function(t,e,n){return{"left-top":e.top+e.height,"right-top":e.top+e.height/2,"left-bottom":e.top-n.height,"right-bottom":e.top+n.height}[t]}},{key:"_getTargetPosition",value:function(t){var e=[t.left,t.top],n=[.5*document.documentElement.clientWidth,.5*document.documentElement.clientHeight],i=["left","top"];return["right","bottom"].forEach(function(t,r){e[r]>n[r]&&(i[r]=t)}),i.join("-")}}]),t}(),V=function(t){var e=t.getBoundingClientRect();return{top:e.top+document.body.scrollTop,left:e.left+document.body.scrollLeft,right:e.left+document.body.scrollTop+e.width,bottom:e.top+document.body.scrollTop+e.height,width:e.width,height:e.height}},U=function(t){var e=t.map(function(t){return V(t)}),n={top:Math.min.apply(Math,e.map(function(t){return t.top})),left:Math.min.apply(Math,e.map(function(t){return t.left})),right:Math.max.apply(Math,e.map(function(t){return t.right})),bottom:Math.max.apply(Math,e.map(function(t){return t.bottom}))};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},X=function(t){var e=t.nodes();return e[0]&&"path"==e[0].tagName?U(e):V(e[0])},F=function(){function e(t,n){u(this,e),this._options=t,this._containerEl=null,this._rendered=!1,this._model=n,this._onStartBinding=this._model.on("start",this._onStart.bind(this)),this._onStepBinding=this._model.on("step",this._onStep.bind(this)),this._onStopBinding=this._model.on("stop",this._onStop.bind(this)),this._positionResolver=new J}return _(e,[{key:"getArrowBox",value:function(){return this._arrowBox}},{key:"isRendered",value:function(){return this._rendered}},{key:"render",value:function(e){return this._containerEl=t.select(e||document.body),this._renderArrow(),this._rendered=!0,this}},{key:"_renderArrow",value:function(){this._arrowEl=this._containerEl.append("div").attr("class",y.arrow+" "+y["arrow-bottom-right"]),this._arrowBox=V(this._arrowEl.node())}},{key:"_onStart",value:function(){return this._arrowEl.style("visibility","visible"),this}},{key:"_onStep",value:function(e){if(!e.selector)return void this._arrowEl.style("visibility","hidden");this._arrowEl.style("visibility","visible");var n=t.selectAll(e.selector),i=X(n),r=this._positionResolver.getArrowPosition(i,this._arrowBox);return this._arrowEl.transition().duration(0).style("top",r.top+"px").style("left",r.left+"px"),this._arrowEl.attr("class",y.arrow+" "+y["arrow-"+r.position]),this}},{key:"_onStop",value:function(){return this._arrowEl.style("display","none"),this}},{key:"destroy",value:function(){return this._onStartBinding.destroy(),this._onStepBinding.destroy(),this._onStopBinding.destroy(),this._arrowEl&&this._arrowEl.remove(),this}}]),e}(),Q=function(){function e(t,n){u(this,e),this._options=t,this._containerEl=null,this._rendered=!1,this._model=n,this._steps=n.getSteps().filter(function(t){return!1!==t.showProgress}),this._numOfSteps=this._steps.length,this._numOfSteps>1&&(this._onStepBinding=this._model.on("step",this._onStep.bind(this)))}return _(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"render",value:function(e){return this._containerEl=t.select(e),this._renderProgress(),this._renderSteps(),this._rendered=!0,this}},{key:"_renderProgress",value:function(){this._progressEl=this._containerEl.append("div").classed(y["window-progress-ct"],!0)}},{key:"_renderSteps",value:function(){var t=this;this._steps.slice(1).forEach(function(){t._progressEl.append("div").classed(y["window-progress-step"],!0)})}},{key:"_resizeSteps",value:function(e){var n=this._getStepWidth(e);t.selectAll("."+y["window-progress-step"]).transition().duration(this._options.animationDuration).style("width",n+"px")}},{key:"_getStepWidth",value:function(t){return(t.windowWidth||this._options.windowWidth)/this._numOfSteps}},{key:"_getProgressWidth",value:function(t,e){return(e.windowWidth||this._options.windowWidth)*(t+1)/this._numOfSteps}},{key:"_onStep",value:function(t){if(!1===t.showProgress)return void this._progressEl.transition().duration(this._options.animationDuration).style("width","0px");var e=this._steps.indexOf(t),n=this._getProgressWidth(e,t);this._progressEl.transition().duration(this._options.animationDuration).style("width",n+"px"),this._resizeSteps(t)}},{key:"destroy",value:function(){return this._rendered&&this._progressEl.remove(),this._onStepBinding&&this._onStepBinding.destroy(),this}}]),e}(),$=function(){function e(t,n){u(this,e),this._options=t,this._containerEl=null,this._rendered=!1,this._model=n,this._onStartBinding=this._model.on("start",this._onStart.bind(this)),this._onStepBinding=this._model.on("step",this._onStep.bind(this)),this._onStopBinding=this._model.on("stop",this._onStop.bind(this)),this._positionResolver=new J,this._arrowRenderer=new F(t,n),this._progressRenderer=new Q(t,n)}return _(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"render",value:function(e){return this._containerEl=t.select(e||document.body),this._renderWindow(),this._arrowRenderer.render(e),this._progressRenderer.render(this._windowEl.node()),this._rendered=!0,this}},{key:"_renderWindow",value:function(){var t=this;this._windowEl=this._containerEl.append("div").attr("class",y.window+" "+this._options.windowClassName).style("width",this._options.windowWidth+"px"),this._nextBtnEl=this._windowEl.append("div").on("click",this._onNextClick.bind(this)).attr("class",y["window-next-btn"]+" onboard-window-next-btn"),this._nextBtnTextEl=this._nextBtnEl.append("span").attr("class",y["window-next-btn-text"]).html(this._options.nextText),this._nextBtnEl.on("mouseover",function(){t._nextBtnEl.classed(y["window-next-btn-hover"],!0)}),this._nextBtnEl.on("mouseout",function(){t._nextBtnEl.classed(y["window-next-btn-hover"],!1)}),this._nextBtnIconEl=this._nextBtnEl.append("div").attr("class",y["window-btn-icon"]+" zmdi zmdi-long-arrow-right"),this._prevBtnEl=this._windowEl.append("div").attr("class",y["window-prev-btn"]+" onboard-window-prev-btn").on("click",this._onPrevClick.bind(this)).html(this._options.prevText),this._prevBtnEl.append("div").attr("class",y["window-btn-icon"]+" zmdi zmdi-long-arrow-left"),this._titleEl=this._windowEl.append("div").attr("class",y["window-title"]+" onboard-window-title"),this._bodyEl=this._windowEl.append("div").attr("class",y["window-body"]+" onboard-window-body"),this._closeEl=this._windowEl.append("div").attr("class",y["window-close"]+" zmdi zmdi-close").on("click",this._onCloseClick.bind(this))}},{key:"_onCloseClick",value:function(){this._model.stop()}},{key:"_onNextClick",value:function(){this._nextBtnEl.classed(y["window-next-btn-hover"],!1),this._model.hasNext()?this._model.next():this._model.stop()}},{key:"_onPrevClick",value:function(){this._model.prev()}},{key:"_onStart",value:function(){return this._windowEl.style("display","block"),this}},{key:"_onStep",value:function(e){if(this._titleEl.html(e.title),this._bodyEl.html(e.text),this._prevBtnEl.classed(y["window-button-has-prev"],this._model.hasPrev()),this._nextBtnEl.classed(y["window-button-has-next"],this._model.hasNext()),this._nextBtnTextEl.html(e.nextText||this._options.nextText),this._windowEl.attr("class",y.window+" "+(e.windowClassName||this._options.windowClassName)),this._windowEl.style("width",(e.windowWidth||this._options.windowWidth)+"px"),!e.selector)return void this._windowEl.transition().duration(this._options.animationDuration).style("left",null).style("top",null);var n=t.selectAll(e.selector),i=X(n),r=V(this._windowEl.node()),o=this._positionResolver.getWindowPosition(i,r,this._arrowRenderer.getArrowBox());return this._windowEl.transition().duration(this._options.animationDuration).style("left",o.left+"px").style("top",o.top+"px"),this._windowEl.classed(y["window-"+o.position],!0),this}},{key:"_onStop",value:function(){return this._windowEl.style("display","none"),this}},{key:"destroy",value:function(){return this._onStartBinding.destroy(),this._onStepBinding.destroy(),this._onStopBinding.destroy(),this._progressRenderer.destroy(),this._arrowRenderer.destroy(),this}}]),e}(),q=function(){function e(t,n){u(this,e),this._options=t,this._containerEl=null,this._rendered=!1,this._model=n,this._observable=new p([]),this._maskRenderer=new K(t,n),this._windowRenderer=new $(t,n)}return _(e,[{key:"isRendered",value:function(){return this._rendered}},{key:"render",value:function(e){return this._containerEl=t.select(e||document.body),this._maskRenderer.render(e),this._windowRenderer.render(e),this._rendered=!0,this}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._maskRenderer.destroy(),this._windowRenderer.destroy(),this}}]),e}(),tt=function(){function t(e){u(this,t),this._steps=e.steps||[],this._currentStep=null,this._currentStepIndex=-1,this._observable=new p(["start","stop","step"])}return _(t,[{key:"getSteps",value:function(){return this._steps}},{key:"start",value:function(){this._currentStepIndex=0,this._currentStep=this._steps[this._currentStepIndex],this._observable.fire("start",this._currentStep,this._currentStepIndex),this._observable.fire("step",this._currentStep,this._currentStepIndex)}},{key:"stop",value:function(){this._observable.fire("stop",this._currentStep,this._currentStepIndex),this._currentStep=null,this._currentStepIndex=-1}},{key:"next",value:function(){this.hasNext()&&(this._currentStep=this._steps[++this._currentStepIndex],this._observable.fire("step",this._currentStep,this._currentStepIndex))}},{key:"prev",value:function(){this.hasPrev()&&(this._currentStep=this._steps[--this._currentStepIndex],this._observable.fire("step",this._currentStep,this._currentStepIndex))}},{key:"hasNext",value:function(){return this._steps.length>this._currentStepIndex+1}},{key:"hasPrev",value:function(){return this._currentStepIndex>0}},{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._currentStep=null,this}}]),t}(),et=function(){function e(t,n){u(this,e),this._options=t,this._model=n,this._onStartBinding=this._model.on("start",this._onStart.bind(this)),this._onStopBinding=this._model.on("stop",this._onStop.bind(this))}return _(e,[{key:"_onStart",value:function(){return t.select(document).on("keydown.onboard",this._onKeyDown.bind(this)),this}},{key:"_onKeyDown",value:function(){if("ArrowLeft"==t.event.key||"Backspace"==t.event.key)this._model.hasPrev()?this._model.prev():this._model.stop();else if("ArrowRight"==t.event.key||"Enter"==t.event.key)this._model.hasNext()?this._model.next():this._model.stop();else{if("Escape"!=t.event.key)return;this._model.stop()}t.event.preventDefault()}},{key:"_onStop",value:function(){return t.select(document).on("keydown.onboard",null),this}},{key:"destroy",value:function(){return this._onStop(),this._onStartBinding.destroy(),this._onStopBinding.destroy(),this}}]),e}();return function(){function t(e){var n=this;u(this,t),this._options={},this._options.fillColor=h(e.fillColor,c),this._options.fillOpacity=h(e.fillOpacity,w),this._options.nextText=h(e.nextText,g),this._options.windowClassName=h(e.windowClassName,b),this._options.animationDuration=h(e.animationDuration,f),this._options.windowWidth=h(e.windowWidth,v),this._options.steps=e.steps,this._observable=new p(["start","stop","step"]),this._model=new tt(this._options),this._model.on("start",function(t,e){n._observable.fire("start",t,e)}),this._model.on("stop",function(t,e){n._observable.fire("stop",t,e)}),this._model.on("step",function(t,e){n._observable.fire("step",t,e)}),this._onboardRenderer=new q(this._options,this._model),this._onboardKeyHandler=new et(this._options,this._model),this.render()}return _(t,[{key:"on",value:function(t,e){return this._observable.on(t,e),this}},{key:"off",value:function(t,e){return this._observable.off(t,e),this}},{key:"destroy",value:function(){return this._observable.destroy(),this._onboardRenderer.destroy(),this._options=null,this._model.destroy(),this._onboardKeyHandler.destroy(),this}},{key:"render",value:function(t){return this._onboardRenderer.render(t),this}},{key:"start",value:function(){return this._model.start(),this}},{key:"stop",value:function(){return this._model.stop(),this}}]),t}()});
//# sourceMappingURL=can-onboard.min.js.map
